Garden Sandbox Relay v2 :root { color-scheme: light dark; --primary: #3b82f6; --bg: #0b132b; --card-bg: #111827; --input-bg: #0f172a; --border: #1f2937; } * { box-sizing: border-box; } body { margin: 0; font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: #e5e7eb; min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; overflow-x: hidden; } .card { width: min(900px, 100%); background: var(--card-bg); border: 1px solid var(--border); border-radius: 18px; padding: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); } .header { margin-bottom: 20px; } h1 { margin: 0; font-size: 20px; letter-spacing: 0.5px; } p.sub { margin: 4px 0 0; color: #9ca3af; font-size: 13px; } .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px; } label { display: block; font-size: 11px; text-transform: uppercase; color: #9ca3af; margin-bottom: 6px; font-weight: 600; } input, button { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border); background: var(--input-bg); color: white; font-size: 14px; } input[type="color"] { height: 40px; padding: 2px; cursor: pointer; } button { background: linear-gradient(135deg, #2563eb, #1d4ed8); font-weight: 600; cursor: pointer; border: none; transition: opacity 0.2s; } button:active { opacity: 0.8; } #status { display: inline-flex; align-items: center; gap: 8px; margin-bottom: 16px; font-size: 13px; padding: 6px 12px; background: rgba(0,0,0,0.2); border-radius: 20px; } .dot { width: 8px; height: 8px; border-radius: 50%; background: #f59e0b; } .ok .dot { background: #10b981; box-shadow: 0 0 8px #10b981; } .retry .dot { animation: pulse 1.5s infinite; } @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } } #canvas-container { position: relative; width: 100%; height: 320px; background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%); border-radius: 14px; border: 1px solid var(--border); overflow: hidden; touch-action: none; cursor: crosshair; } canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; } .canvas-hint { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; opacity: 0.2; font-weight: 800; letter-spacing: 4px; font-size: 14px; text-align: center; } .log { margin-top: 20px; height: 100px; overflow-y: auto; font-size: 11px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 10px; font-family: ui-monospace, monospace; color: #9ca3af; border: 1px solid var(--border); } #master-footer { margin-top: 24px; font-size: 10px; color: #4b5563; text-align: center; letter-spacing: 0.05em; } 

Garden Sandbox Relay

Drag on the field to create musical trails across all devices.

Initializing... 

Session ID 

Trail Color 

Copy Share Link 

DRAG TO STRUM & SYNC

Garden Sandbox Relay - 2.0.1 - 2026-01-07 01:53 AM 

(() => { const canvas = document.getElementById('trail-canvas'); const ctx = canvas.getContext('2d'); const logEl = document.getElementById('log'); const colorPicker = document.getElementById('color-picker'); const statusLabel = document.querySelector('#status .label'); const statusDiv = document.getElementById('status'); const sessionIdField = document.getElementById('session-id'); let audioCtx = null; let particles = []; let isDragging = false; let lastSend = 0; const clientId = (crypto.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2, 10)); // Resolve Session const urlParams = new URLSearchParams(window.location.search); let session = urlParams.get('session'); if (!session) { session = Math.random().toString(36).substring(2, 8); urlParams.set('session', session); try { // history.replaceState can fail in sandboxed/blob environments window.history.replaceState({}, '', '?' + urlParams.toString()); } catch (e) { console.warn("Could not update URL state:", e); } } const topic = `garden-sandbox-${session}`; sessionIdField.value = session; // Canvas Management function resize() { const dpr = window.devicePixelRatio || 1; canvas.width = canvas.offsetWidth * dpr; canvas.height = canvas.offsetHeight * dpr; ctx.scale(dpr, dpr); } window.addEventListener('resize', resize); resize(); // Audio Engine: Strumming Logic function strum(freq = 440) { try { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); if (audioCtx.state === 'suspended') audioCtx.resume(); const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain(); osc.type = 'triangle'; osc.frequency.setValueAtTime(freq, audioCtx.currentTime); osc.frequency.exponentialRampToValueAtTime(freq * 0.8, audioCtx.currentTime + 0.4); gain.gain.setValueAtTime(0.15, audioCtx.currentTime); gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.4); osc.connect(gain).connect(audioCtx.destination); osc.start(); osc.stop(audioCtx.currentTime + 0.4); } catch (e) { console.warn("Audio failed", e); } } // Particle System function addParticle(x, y, color) { particles.push({ x, y, color, life: 1.0, vx: (Math.random() - 0.5) * 1, vy: (Math.random() - 0.5) * 1, size: Math.random() * 5 + 3 }); } function animate() { ctx.clearRect(0, 0, canvas.width, canvas.height); particles = particles.filter(p => p.life > 0.01); for (let p of particles) { ctx.globalAlpha = p.life; ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2); ctx.fill(); p.x += p.vx; p.y += p.vy; p.life *= 0.96; } requestAnimationFrame(animate); } animate(); function handleInput(e) { if (!isDragging) return; const rect = canvas.getBoundingClientRect(); const clientX = e.clientX || (e.touches && e.touches[0].clientX); const clientY = e.clientY || (e.touches && e.touches[0].clientY); if (clientX === undefined) return; const x = clientX - rect.left; const y = clientY - rect.top; const color = colorPicker.value; addParticle(x, y, color); const now = Date.now(); if (now - lastSend > 50) { const freq = Math.floor(200 + (1 - y / rect.height) * 800); strum(freq); broadcast({ type: 'strum_drag', x: x / rect.width, y: y / rect.height, color: color, freq: freq, cid: clientId }); lastSend = now; } } canvas.addEventListener('pointerdown', (e) => { isDragging = true; handleInput(e); }); window.addEventListener('pointerup', () => isDragging = false); window.addEventListener('pointermove', handleInput); async function broadcast(payload) { try { await fetch(`https://ntfy.sh/${topic}`, { method: 'POST', body: JSON.stringify(payload) }); } catch (err) { console.error("Broadcast failed", err); } } function log(msg) { const entry = document.createElement('div'); entry.textContent = `> ${msg}`; logEl.prepend(entry); if (logEl.children.length > 20) logEl.lastChild.remove(); } function connect() { statusDiv.className = 'retry'; statusLabel.textContent = "Connecting..."; const eventSource = new EventSource(`https://ntfy.sh/${topic}/sse`); eventSource.onopen = () => { statusDiv.className = 'ok'; statusLabel.textContent = "Live - Relay Active"; log("Connected to session: " + session); }; eventSource.onerror = () => { statusDiv.className = 'retry'; statusLabel.textContent = "Reconnecting..."; }; eventSource.onmessage = (e) => { try { const data = JSON.parse(e.data); const msg = typeof data.message === 'string' ? JSON.parse(data.message) : data.message; if (msg && msg.cid !== clientId) { if (msg.type === 'strum_drag') { const rect = canvas.getBoundingClientRect(); const rx = msg.x * rect.width; const ry = msg.y * rect.height; addParticle(rx, ry, msg.color); strum(msg.freq); } } } catch (err) {} }; } document.getElementById('copy-url').onclick = () => { // Build a more robust URL for sharing even in blob environments let shareUrl = window.location.href.split('?')[0]; if (shareUrl.startsWith('blob:')) { // Fallback for blob-based previews shareUrl = "Session ID: " + session; } else { shareUrl += '?session=' + session; } navigator.clipboard.writeText(shareUrl).then(() => { log("Session link copied to clipboard"); const btn = document.getElementById('copy-url'); const oldText = btn.textContent; btn.textContent = "Copied!"; setTimeout(() => btn.textContent = oldText, 2000); }); }; connect(); })(); 